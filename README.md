# AstrBot 图像对称处理插件


> ⚠️ **慎用！**：本插件完全由AI编写，连readme.md也是AI写的，作者是高中生（最近期末考没时间测试😭），尚未经过充分测试，期末考试完以后再来处理ai审查发现的问题，目前插件能够正常工作但是风险！审查结果如下https://github.com/AstrBotDevs/AstrBot/issues/4592
>
> ### ❗ 需要社区帮助修复的问题：
1. **GIF处理问题**：GIF图片处理后不会动了不会修😭我没招了期待有大佬帮忙修复，欢迎Pull Request!
2. **内存泄漏**：还没测过！用久了会不会内存爆炸？🤯
3. **大文件处理**：超大图片/GIF处理稳定性
4. **并发处理**：多人同时使用时是否稳定

**一个为AstrBot设计的图像对称处理插件，专门生成各种"诡异"的对称图片，希望能给大家带来一点欢乐！😂**

## ✨ 功能特性

- **四种对称模式**：左对称、右对称、上对称、下对称
- **多图像源支持**：支持图片、GIF、QQ用户头像
- **智能解析**：自动识别回复消息中的图片
- **可配置**：用户可以自定义文件大小限制等参数
- **静默模式**：可选是否显示处理提示
- **自动清理**：自动清理临时文件，避免占用空间
- **诡异美学**：专门制造各种奇奇怪怪的对称图片！

## 🎮 指令列表

### 基础指令
| 指令 | 功能描述 |
|------|----------|
| `左对称` | 左半边图像对称到右边 |
| `右对称` | 右半边图像对称到左边 |
| `上对称` | 上半边图像对称到下面 |
| `下对称` | 下半边图像对称到上面 |
| `对称帮助` | 显示详细使用说明 |

## 📸 使用示例

### 方式1：回复图片消息
```
用户：(引用一张图片)/左对称
机器人：[发送对称后的诡异图片]
```

### 方式2：处理@用户头像
```
用户：/右对称 @张三
机器人：[发送张三头像的对称诡异版本]
```

### 方式3：同消息发送
```
用户：[图片] /上对称
机器人：[发送对称后的图片]
```

## 🤖 诡异效果展示

这个插件最适合制造：
- **恐怖对称脸**：把人的脸对称一下，制造恐怖谷效应
- **诡异表情包**：对称后的表情包往往效果"惊人"
- **鬼畜头像**：朋友的头像对称一下，制造搞笑效果


## ⚙️ 配置说明

插件支持以下可配置选项：

| 配置项 | 类型 | 默认值 | 描述 |
|--------|------|--------|------|
| 图像大小限制 (MB) | 数字 | 10 | 普通图像最大大小 |
| GIF大小限制 (MB) | 数字 | 15 | GIF动画最大大小 |
| 处理超时时间 (秒) | 数字 | 30 | 处理超时时间 |
| 输出图像质量 | 数字 | 85 | JPEG图像质量 (1-100) |
| 启用GIF处理 | 布尔 | true | 是否处理GIF动画 |
| 启用自动压缩 | 布尔 | true | 是否自动压缩图像 |
| 静默模式 | 布尔 | true | 是否显示处理提示 |
| 启用自动清理 | 布尔 | true | 是否自动清理文件 |
| 文件保留时间 (小时) | 数字 | 1 | 文件保留时间 |
| 启用@用户头像功能 | 布尔 | true | 是否支持@用户头像 |

## 📦 安装方法（有空传AstrBot插件市场）

### 方法1：从GitHub安装（推荐）
1. 进入AstrBot Web管理界面
2. 点击"插件市场"或"上传插件"
3. 输入GitHub仓库地址：`https://github.com/FenChen0211/astrbot-plugin-pic-mirror`
4. 点击安装

### 方法2：手动安装
1. [下载最新Release](https://github.com/FenChen0211/astrbot-plugin-pic-mirror/releases)
2. 在AstrBot插件管理界面选择"上传插件"
3. 选择下载的ZIP文件
4. 启用插件

## 🐛 已知问题与求助

### ❗ 需要社区帮助测试的问题：
1. **内存泄漏**：还没测过！用久了会不会内存爆炸？🤯
2. **大文件处理**：超大图片/GIF处理稳定性
3. **并发处理**：多人同时使用时是否稳定
4. **长时运行**：长时间运行后是否有性能下降

### 📝 如何反馈问题：
1. 在GitHub提Issue
2. 描述具体操作步骤
3. 提供错误日志（如果有）
4. 说明你的AstrBot版本

## 🛠️ 技术架构

```
astrbot-plugin-pic-mirror/
├── main.py # 主入口
├── core/ # 核心业务逻辑
│ ├── image_handler.py # 图像处理主逻辑
│ ├── avatar_service.py # QQ头像获取
│ └── cleanup_manager.py # 文件清理管理
├── utils/ # 工具函数
│ ├── file_utils.py # 文件操作
│ ├── network_utils.py # 网络请求
│ └── message_utils.py # 消息解析
├── services/ # 服务层
│ └── config_service.py # 配置管理
├── image_processor.py # 对称算法实现
├── config.py # 配置数据类
├── _conf_schema.json # 配置模式定义
└── metadata.yaml # 插件元数据
```

## 💻 开发说明

### 依赖
- Pillow >= 10.0.0 (图像处理)
- aiohttp >= 3.9.0 (网络请求)

### 构建插件包
```bash
# 安装依赖
pip install pillow aiohttp

# 打包
zip -r astrbot-plugin-pic-mirror.zip *
```

## 🤝 贡献指南

欢迎任何形式的贡献！特别是：

1. **测试报告**：帮我测试内存泄漏和稳定性
2. **Bug修复**：发现并修复问题
3. **功能建议**：有什么好玩的对称想法？
4. **代码优化**：AI写的代码可能有优化空间

### 贡献流程：
1. Fork 本仓库
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启一个 Pull Request
。

## 🙏 致谢与说明

- **作者**：FenChen0211（一个忙着期末考的高中生）
- **代码编写**：完全由AI助手编写完成
- **测试状态**：基本功能可用，但需要更多测试
- **初衷**：给大家带来一点欢乐，制造有趣的对称图片

> 特别感谢：所有帮忙测试的朋友！如果发现内存泄漏问题，请温柔地告诉我... 

## 🌟 最后的话

虽然这是个"AI编写、高中生维护、还没测内存泄漏"的三无产品，但希望它能给你带来一些乐趣！如果你用它制造出了特别诡异的图片，欢迎分享！喜欢的话请给我点一个Star！

**祝大家玩得开心，制造出更多奇奇怪怪的对称图片！** 🎉👻
